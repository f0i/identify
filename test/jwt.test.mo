import { print } "mo:base/Debug";
import Base64 "../src/ICgsi_backend/Base64";
import Jwt "../src/ICgsi_backend/JWT";

print("Start");

let res = Base64.StdEncoding.decodeTextToText("dGVzdA");
assert res == #ok("test");

let testJWT = "eyJhbGciOiJSUzI1NiIsImtpZCI6IjVhYWZmNDdjMjFkMDZlMjY2Y2NlMzk1YjIxNDVjN2M2ZDQ3MzBlYTUiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiIzNzY2NTA1NzExMjctdnBvdGtyNGt0N2Q3Nm84bWtpMDlmN2Eydm9wYXRkcDYuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20iLCJhdWQiOiIzNzY2NTA1NzExMjctdnBvdGtyNGt0N2Q3Nm84bWtpMDlmN2Eydm9wYXRkcDYuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20iLCJzdWIiOiIxMTQ4MDgxMjIyNDk0OTIxNTI3ODQiLCJlbWFpbCI6ImYwaWRlc2lyZUBnb29nbGVtYWlsLmNvbSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJuYmYiOjE3MjcxNzMzNjgsIm5hbWUiOiJNYXJ0aW4gUy4iLCJwaWN0dXJlIjoiaHR0cHM6Ly9saDMuZ29vZ2xldXNlcmNvbnRlbnQuY29tL2EvQUNnOG9jSmRXWU1SRGFuU0NxdlpmdDlpQ0lhNHYydEdlX241SmFGNm03WU9vRDZZdV9wS1N3UlBzZz1zOTYtYyIsImdpdmVuX25hbWUiOiJNYXJ0aW4iLCJmYW1pbHlfbmFtZSI6IlMuIiwiaWF0IjoxNzI3MTczNjY4LCJleHAiOjE3MjcxNzcyNjgsImp0aSI6IjBhZGU5YWZlOGFlMTk5ZTMyYzQxZGJiMTBlODU5NDllZDUxN2Y1YmIifQ.Gq3-E3VuSCBMWrUEpAwWSuL7rx7b-mjHIy31TJLpyKqcPr5_NLXd-Z5Vp7OVW4Dq-XzlTfid6RVoHcx2Rbko0S1qqlWKy3D6o7xL_XJs2GXDFWnFdQSGwRO20drFzEX3C44UKAv6SaSrcKZuCiHJkNYfS90FBrbBImwM3DS3X7nOMQf-IKMvZ6GemW9huciECApbDhqB7N1C1He9R8NNK7BIUIqV0EBnGhvCouRvrjyLRjuclSnUSOQw7Bchp_Iwp6Ld0YWTwoUmiD9aji4sdn_BHRtITyz_e27BPbECcD6DXR1WMRDJPGmzkjCoFB5w7rRYKcQiXavksl-FpkCAaA";

// Google public key from https://www.googleapis.com/oauth2/v3/certs
let n64 = "jPxgqe78Uy8UI0nrbys8zFQnskdLnvY9DFAKbI9Or7sPc7vhyQ-ynHWXrvrv3J3EVqcqwZSTAjiKbSbIhKRF2iXyIP5jmhS6QTUQb7D8smC89yZi6Ii-AzpH6QKvmhU7yJ1u0odMM1UDUS5bH5aL50HxxqqaQGlZ7PFOT0xrauAFW-3ONVc7_tXGMbfYRzeRrXqaONJ1B9LOconUlsBsL0U1TepINyztbwjM3NBlvEuBX0m4ZbCFznGoWmnix3FuUS4gAybOO3WYr6Zd71cKBFPfdpMMfNjWM2pf1-1O1IF8iArGbvngn8Vk5QGH3MkJDA_JgZOu9pI64LSIEKG02w";
let e64 = "AQAB";
let e = 65537;
let n = 17797814724737307948365068663031043196332897003205008045489352412929229479912633631817693590668302321217322738959845910990818269854874912555137722029635803458885576011375683778903919221020745577446068752114400629882273787085368310999291972239158554623118288635881726144788152429995473727616020302924986504730236624792668671674873282193343016230412795330387853119407285321348848278437936378800688745723866112002540443985533651466748959687811499399740933119325670601477017545787817872963105344801301632057580987461867416865951021288446883260148765710505631139284499317231559095707063354489710993939659784492644634309851;
let kid = "5aaff47c21d06e266cce395b2145c7c6d4730ea5";

let data = Jwt.decode(testJWT, { e; n; kid });
print(debug_show (data));
